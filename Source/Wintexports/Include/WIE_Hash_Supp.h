#pragma once

#include "WIE_Windows.h"

/* A_SHA */

typedef struct _A_SHA_CTX {
    UCHAR Buffer[64];
    ULONG State[5];
    ULONG Count[2];
} A_SHA_CTX, *PA_SHA_CTX;

#define A_SHA_DIGEST_LEN 20

NTSYSAPI
VOID
RSA32API
A_SHAInit(
  _Inout_ PA_SHA_CTX Context);

NTSYSAPI
VOID
RSA32API
A_SHAUpdate(
  _Inout_ PA_SHA_CTX Context,
  _In_reads_(BufferSize) PUCHAR Buffer,
  ULONG BufferSize);

NTSYSAPI
VOID
RSA32API
A_SHAFinal(
  _Inout_ PA_SHA_CTX Context,
  _Out_writes_bytes_(A_SHA_DIGEST_LEN) PUCHAR Result);

/* MD5 */

typedef struct _MD5_CTX {
    ULONG Count[2];
    ULONG State[4];
    UCHAR Buffer[64];
    UCHAR Hash[16];
} MD5_CTX, *PMD5_CTX;

#define MD5_DIGEST_LEN 16

NTSYSAPI
VOID
RSA32API
MD5Init(
  _Inout_ PMD5_CTX Context);

NTSYSAPI
VOID
RSA32API
MD5Update(
  _Inout_ PMD5_CTX Context,
  _In_reads_(BufferSize) PUCHAR Buffer,
  ULONG BufferSize);

NTSYSAPI
VOID
RSA32API
MD5Final(
  _Inout_ PMD5_CTX Context);

/* MD4 */

typedef struct _MD4_CTX {
    ULONG State[4];
    ULONG Count[2];
    UCHAR Buffer[64];
    UCHAR Hash[16];
} MD4_CTX, *PMD4_CTX;

#define MD4_DIGEST_LEN 16

NTSYSAPI
VOID
RSA32API
MD4Init(
  _Inout_ PMD4_CTX Context);

NTSYSAPI
VOID
RSA32API
MD4Update(
  _Inout_ PMD4_CTX Context,
  _In_reads_(BufferSize) PUCHAR Buffer,
  ULONG BufferSize);

NTSYSAPI
VOID
RSA32API
MD4Final(
  _Inout_ PMD4_CTX Context);
